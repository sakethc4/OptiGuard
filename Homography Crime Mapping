<!DOCTYPE html>
<html>
<head>
    <title>Homography Crime Mapping - DMV Metro</title>
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        #map {
            height: 600px;
            width: 100%;
        }
        .danger-tooltip {
            background-color: rgba(255, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 14px;
        }
        .threat-score-box {
            background-color: rgba(255, 255, 255, 0.8);
            padding: 10px;
            border-radius: 4px;
            font-size: 14px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="map"></div>

    <script>
        // ... (previous code remains the same)

        // Add aggressor and victim markers to the map
        var aggressorMarker = L.marker(path[0], { icon: aggressorIcon }).addTo(map);
        var victimMarker = L.marker(path[0], { icon: victimIcon }).addTo(map);

        // Add danger value tooltip to the aggressor marker
        var dangerValue = 0.33;
        aggressorMarker.bindTooltip(dangerValue.toFixed(2), {
            permanent: true,
            direction: 'top',
            offset: [0, -20],
            className: 'danger-tooltip'
        });

        // Add threat score box to the top right corner
        var threatScoreBox = L.control({ position: 'topright' });
        threatScoreBox.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'threat-score-box');
            div.innerHTML = 'Assailant Average Threat Score: ' + dangerValue.toFixed(2);
            return div;
        };
        threatScoreBox.addTo(map);

        // Animate the markers along the path
        var currentIndex = 0;
        var animationSpeed = 100; // Adjust the speed of animation (in milliseconds)
        var interpolationSteps = 50; // Number of interpolation steps between path points

        function animateMarkers() {
            // ... (animation code remains the same)
        }

        animateMarkers();
    </script>
</body>
</html>
